# Экзамен. SQL

## Оглавление

1. [Что такое SQL?](#1-Что-такое-SQL)
2. [Что такое DML и DDL?](#2-Что-такое-DML-и-DDL)
3. [Что такое первичный ключ?](#3-Что-такое-первичный-ключ)
4. [Что такое внешний ключ?](#4-Что-такое-внешний-ключ)
5. [Какие виды связей между таблицами существуют и как они организуются?](#5-Какие-виды-связей-между-таблицами-существуют-и-как-они-организуются)
6. [Напишите как вставить, удалить, обновить данные в(из) таблицу(ы).](#6-Напишите-как-вставить-удалить-обновить-данные-в(из)-таблицу(ы).)
7. [Что такое нормализация БД?](#7-Что-такое-нормализация-БД)
8. [Что такое денормализация БД? Для чего она нужна?](#8-Что-такое-денормализация-БД-Для-чего-она-нужна)
9. [Что такое кластерный и некластерный индексы?](#9-Что-такое-кластерный-и-некластерный-индексы)
10. [Какие типы соединений (join) таблиц существуют? В чем их разница?](#10-Какие-типы-соединений-join-таблиц-существуют-В-чем-их-разница)
11. [Что такое SQL курсор?](#11-Что-такое-SQL-курсор)
12. [Опишите шаги по созданию и использованию курсора.](#12-Опишите-шаги-по-созданию-и-использованию-курсора)
13. [Что такое транзакция?](#13-Что-такое-транзакция)
14. [Что такое триггер? Какие типы триггеров Вы знаете?](#14-Что-такое-триггер-Какие-типы-триггеров-Вы-знаете)
15. [В чем разница между where и having?](#15-В-чем-разница-между-where-и-having)
16. [Что такое подзапрос (sub-query)?](#16-Что-такое-подзапрос-sub-query)
17. [Что такое union?](#17-Что-такое-union)
18. [Что такое group by?](#18-Что-такое-group-by)
19. [Что такое хранимые процедуры?](#19-Что-такое-хранимые-процедуры)
20. [Что такое view(Представление)?](#20-Что-такое-view-Представление)
21. [Что такое JDBC?](#21-Что-такое-JDBC)
22. [Что нужно для работы с той или иной БД?](#22-Что-нужно-для-работы-с-той-или-иной-БД)
23. [Как зарегистрировать драйвер?](#)
24. [Как получить Connection?](#)
25. [Что такое Statement, PrepareStatement? В чем разница между ними?](#)
26. [Что такое ResultSet?](#)
27. [В чем разница между методами execute, executeUpdate, executeQueury?](#)
28. [Можно ли использовать возвращаемое значение execute() для проверки, что что-то обновилось?](#)
29. [Как получить при вставке сгенерированные ключи? Как это сделать на чистом sql?](#)
30. [Для чего используется конструкция try-with-resources?](#)

## 1 Что такое SQL?

SQL - Structured Query Language - структурированный язык запросов - специальный язык для работы с базами данных. Набор
команд, который используется для работы с БД, называется _скриптом_.

[К оглавлению &#8593;](#Оглавление)

## 2 Что такое DML и DDL?

DML - Data Manipulation Library - операции над самими данными (создание, получение, удаление, обновление самих данных)  
DDL - Data Declaration Library - операции над структурой данных (создание, удаление, изменение и т.д таблиц и баз
данных)

[К оглавлению &#8593;](#Оглавление)

## 3 Что такое первичный ключ?

Primary Key - идентификатор записи в таблице (запись - это строка в таблице) - это некоторый атрибут или несколько
атрибутов, которые однозначно характеризуют запись -> по идентификатору можно однозначно идентифицировать запись, то
есть найти её. Чаще всего в качестве идентификатора берут число, так как по числам проще искать и их легко представить.

[К оглавлению &#8593;](#Оглавление)

## 4 Что такое внешний ключ?

Foreign Key - связь с другой таблицей, то есть ссылка на какой-то столбец другой таблицы.

[К оглавлению &#8593;](#Оглавление)

## 5 Какие виды связей между таблицами существуют и как они организуются?

Существуют:

+ many-to-one: для связи между собой таблиц используется внешний ключ - атрибут таблицы, который содержит значения из
  другой таблицы, что позволяет связать записи между собой. Для этого используется ключевое слово REFERENCES. Это
  значит, что значения данного столбца - значения связываемой таблицы.

```sql
 create table position
 (
     id   serial primary key,
     name varchar(255)
 );
create table employees
(
    id          serial primary key,
    name        varchar(255),
    position_id int references position (id)
);
insert into position(name)
values ('programmer');
insert into employees(name, position_id)
VALUES ('Ivan', 1);
```

+ many-to-many: организуется с помощью вспомогательной таблицы, в которой идет двойное применение REFERENCES.

```sql
 create table students
 (
     id   serial primary key,
     name varchar(255)
 );

create table courses
(
    id   serial primary key,
    name varchar(255)
);

create table students_courses
(
    id         serial primary key,
    student_id int references students (id),
    course_id  int references courses (id)
);
```

+ one-to-one: есть однонаправленная (unidirectional) и двунаправленная (bidirectional)

Однонаправленная:

```sql
create table passport
(
    id     serial primary key,
    seria  int,
    number int
);

create table people
(
    id          serial primary key,
    name        varchar(255),
    passport_id int references passport (id) unique
);
```

Рядом с внешним ключом стоит unique. Это значит, что данное значение уникально среди всех записей данного столбца. Без
этого ограничения(constraint) мы получим связь many-to-one. Теперь по записи в таблице людей мы можем перейти в таблицу
паспорта для уточнения данных.

Двунаправленная:

```sql
create table passport
(
    id     serial primary key,
    seria  int,
    number int
);

create table people
(
    id   serial primary key,
    name varchar(255)
);

create table passport_people
(
    id          serial primary key,
    passport_id int references passport (id) unique,
    people_id   int references people (id) unique
);
```

Используются ограничения на внешние ключи unique, иначе мы получим связь many-to-many.

[К оглавлению &#8593;](#Оглавление)

## 6 Опишите как вставить, удалить, обновить данные в(из) таблицу(ы).

Для вставки данных в таблицу используется команда _INSERT_:

```sql
INSERT INTO table_name(attr1, attrN)
VALUES (attr1_value, attrN_value) l
```

Для удаления данных используется команда _DELETE_:

```sql
DELETE
FROM table_name;
```

Для обновления данных используется команда _UPDATE_:

```sql
UPDATE table_name
SET attr1 = attr1_value,
    attrN = attrN_value;
```

[К оглавлению &#8593;](#Оглавление)

## 7 Что такое нормализация БД?

Нормализация — это процесс организации данных в базе данных, включающий создание таблиц и установление отношений между
ними в соответствии с правилами, которые обеспечивают защиту данных и делают базу данных более гибкой, устраняя
избыточность и несогласованные зависимости.

[К оглавлению &#8593;](#Оглавление)

## 8 Что такое денормализация БД? Для чего она нужна?

[К оглавлению &#8593;](#Оглавление)

## 9 Что такое кластерный и некластерный индексы?

[К оглавлению &#8593;](#Оглавление)

## 10 Какие типы соединений (join) таблиц существуют? В чем их разница?

+ inner: берется запись из таблицы табл1 и берется запись из таблицы табл2, если значения по столбцам этих записей
  удовлетворяют условию, прописанному через on, то конечная запись (запись из значений столбцов табл1 и табл2) попадает
  в результат.
+ outer: берется исходная таблица и для каждой ее записи находится запись, которая бы удовлетворяла условию. Если она не
  будет найдена, то по столбцам будут стоять null.
+ cross: результатом является декартово множество, т.е. все пары элементов. Например, если в таблице 1 N записей, а в
  таблице 2 M записей, то мы получим в результате N * M записей.

[К огавлению &#8593;](#Оглавление)

## 11 Что такое SQL курсор?

[К огавлению &#8593;](#Оглавление)

## 12 Опишите шаги по созданию и использованию курсора.

[К огавлению &#8593;](#Оглавление)

## 13 Что такое транзакция?

[К огавлению &#8593;](#Оглавление)

## 14 Что такое триггер? Какие типы триггеров Вы знаете?

[К огавлению &#8593;](#Оглавление)

## 15 В чем разница между where и having?

where нельзя использовать с агрегатными функциями

[К огавлению &#8593;](#Оглавление)

## 16 Что такое подзапрос (sub-query)?

[К огавлению &#8593;](#Оглавление)

## 17 Что такое union?

[К огавлению &#8593;](#Оглавление)

## 18 Что такое group by?

[К огавлению &#8593;](#Оглавление)

## 19 Что такое хранимые процедуры?

[К огавлению &#8593;](#Оглавление)

## 20 Что такое view(Представление)?

[К огавлению &#8593;](#Оглавление)

## 21 Что такое JDBC?

JDBC – это API, т.е. набор вспомогательных классов, которое позволяет работать с базами данных. Причем JDBC
предоставляет единый интерфейс для работы с ними, ведь бывают различные базы данных.

[К огавлению &#8593;](#Оглавление)

## 22 Что нужно для работы с той или иной БД?

Драйвер

[К огавлению &#8593;](#Оглавление)

## 23 Как зарегистрировать драйвер?

Properties cfg;   
Class.forName(cfg.getProperty("driver"));

[К огавлению &#8593;](#Оглавление)

## 24 Как получить Connection?

Properties cfg;
Connection connection = DriverManager.getConnection(cfg.getProperty("url"), cfg.getProperty("username"),
cfg.getProperty("password"));
[К огавлению &#8593;](#Оглавление)

## 25 Что такое Statement, PrepareStatement? В чем разница между ними?

[К огавлению &#8593;](#Оглавление)

## 26 Что такое ResultSet?

[К огавлению &#8593;](#Оглавление)

## 27 В чем разница между методами execute, executeUpdate, executeQueury?

[К оглавлению &#8593;](#Оглавление)

## 28 Можно ли использовать возвращаемое значение execute() для проверки, что что-то обновилось?

[К огавлению &#8593;](#Оглавление)

## 29 Как получить при вставке сгенерированные ключи? Как это сделать на чистом sql?

[К огавлению &#8593;](#Оглавление)

## 30 Для чего используется конструкция try-with-resources?

[К оглавлению &#8593;](#Оглавление)